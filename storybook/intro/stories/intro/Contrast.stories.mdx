import { useState } from 'react';
import { Meta, Preview, Story } from '@storybook/addon-docs';
import { colors as designColors } from '@cypress-design/css/dist/colors';
import Select from 'react-select';
import flatten from 'flat';
import { map, pick } from 'lodash'

import { Contrast } from '../src/contrast';
import { ContrastFullTable } from '../src/contrast-full-table';

export const colorways = [
  'gray',
  'red',
  'orange',
  'jade',
  'indigo',
  'purple',
  'teal',
  'fuchsia',
  'yellow',
  'green',
  'magenta',
  'black',
  'white',
];

# Contrast

<Meta title="Intro/Contrast" />

The below widget allows you to calculate which of our brand colors meet accessibility criteria of AA or AAA when displayed on any background color. The collapsed table all the way at the bottom displays the exact contrast ratio for all colors. [See WebAIM for more info about contrast accessibility and contrast ratios.](https://webaim.org/articles/contrast/)

AA is generally the minimum acceptable bar for our designs at Cypress.

Large text has different required contrast ratios. Text is considered large if it is 18px and bold or larger, or 24px or larger. Those sizes and weights are displayed here.

If you're building something using colors outside our brand colors, please check the contrast ratio using a [contrast checker](https://webaim.org/resources/contrastchecker/) by pasting the exact colors into the tool. Using a color picker can be unreliable for multiple reasons.

Note: All evaluations assume full opacity.

<Preview>
  <Story name="Contrast">
    {() => {
      {
        /* NOTE: if you put any empty lines in here, it will break: https://github.com/storybookjs/storybook/issues/9602#issuecomment-581021436 */
      }
      const namedColors = pick(designColors, colorways);
      const colors = flatten(namedColors, {
        delimiter: '-',
      });
      const [backgroundColor, setBackgroundColor] = useState({ value: colors['gray-1000'], label: 'bg-gray-1000' });
      const paletteList = map(colors, (hex, name) => {
        return {
          value: hex,
          label: `bg-${name}`
        }
      })
      const onChange = (selection) => {
        setBackgroundColor(selection);
      };
      return (
        <div>
          <div
            style={{
              border: `2px solid ${colors['jade-400']}`,
              marginBottom: '48px',
            }}
          >
            <p className="m-4">Choose background color</p>
            {/* <p>grayA1 is white and grayA2 is black</p> */}
            <Select
              className="m-4"
              options={paletteList}
              defaultValue={backgroundColor}
              onChange={onChange}
            />
          </div>
          <div>
            <Contrast background={backgroundColor} colors={colors} colorways={colorways} />
            <ContrastFullTable background={backgroundColor} colors={colors} />
          </div>
        </div>
      );
    }}
  </Story>
</Preview>
